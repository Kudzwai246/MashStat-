<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8BMMTDWP3G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}  
    gtag('js', new Date());
    gtag('config', 'G-8BMMTDWP3G');
  </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mash 100 – Top Songs</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Montserrat', sans-serif; background: #121212; color: #fff; padding: 20px; }
    .logo-link { display: block; text-align: center; margin-bottom: 20px; }
    .logo { height: 50px; }
    h1 { font-family: 'Playfair Display', serif; text-align: center; font-size: 2.5rem; margin-bottom: 5px; }
    .description { text-align: center; color: #aaa; margin-bottom: 30px; font-size: 1rem; }
    .chart { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px,1fr)); gap: 16px; }
    .chart-item { background: #1e1e1e; border-radius: 6px; padding: 12px; position: relative; display: flex; flex-direction: column; justify-content: space-between; min-height: 160px; transition: transform .2s; }
    .chart-item:hover { transform: scale(1.02); }
    .chart-item.highlight { grid-column: 1 / -1; background: #333; box-shadow: 0 0 20px rgba(255,0,85,0.6); }
    .artwork { width: 100%; height: 0; padding-bottom: 100%; background-size: cover; background-position: center; border-radius: 4px; margin-bottom: 8px; }
    .rank { font-size: 1.4rem; font-weight: 700; color: #ff0055; }
    .song-title { font-size: 1.1rem; font-weight: 600; margin: 4px 0; color: #fff; }
    .artist-name { color: #0af; font-style: italic; font-size: 0.9rem; }
    .streams { font-size: 0.75rem; color: #ccc; margin-top: 4px; }
    .trend { position: absolute; top: 8px; right: 8px; font-size: 1.2rem; }
    .trend.down { color: #f55; } .trend.up { color: #5f5; } .trend.new { color: #5f5; }
    .meta { display: flex; justify-content: space-between; font-size: 0.75rem; color: #ccc; margin-top: 8px; }
    .meta .label { font-weight: 600; margin-right: 4px; }
  </style>
</head>
<body>

  <a href="index.html" class="logo-link">
    <img src="mashstat_logo.png" alt="MashStat Logo" class="logo">
  </a>
  <h1>Mash 100 – Top Songs</h1>
  <p class="description">This chart ranks the top 100 most streamed tracks in Zimbabwe across all major platforms. Updated weekly.</p>

  <div id="chart" class="chart"></div>

  <script>
    // Fallback data if fetch fails or too few entries
    const fallbackData = [
      { rank:1, title:"Hope dzandairota", artist:"Bling 4", streams:0, votes:0, artworkUrl:"", trend:"new", peak:1, last:null },
      { rank:2, title:"Zampele", artist:"Oriyano ft. Spirit", streams:0, votes:0, artworkUrl:"", trend:"down", peak:1, last:1 }
      // ...add more if desired...
    ];

    function renderItem(item) {
      const div = document.createElement('div');
      div.className = 'chart-item' + (item.rank===1?' highlight':'');
      const art = document.createElement('div');
      art.className = 'artwork';
      art.style.backgroundImage = item.artworkUrl ? `url(${item.artworkUrl})` : 'none';
      div.appendChild(art);
      div.innerHTML += `
        <span class="rank">${item.rank}.</span>
        <span class="song-title">${item.title}</span>
        <span class="artist-name">${item.artist}</span>
        <span class="trend ${item.trend}">${ item.trend==='new'?'●':(item.trend==='up'?'▲':'▼') }</span>
        <div class="streams">Streams: ${item.streams.toLocaleString()} &nbsp; Votes: ${item.votes}</div>
        <div class="meta">
          <div><span class="label">Peak:</span>${item.peak}</div>
          <div><span class="label">Last:</span>${item.last===null?'—':item.last}</div>
        </div>`;
      return div;
    }

    async function loadChart() {
      let data;
      try {
        const resp = await fetch('mash100.json');
        data = await resp.json();
        if (!Array.isArray(data) || data.length < 5) throw new Error();
      } catch {
        data = fallbackData;
      }
      data.sort((a,b)=>a.rank-b.rank);
      const chart = document.getElementById('chart');
      chart.innerHTML = '';
      data.forEach(item=>chart.appendChild(renderItem(item)));
    }

    loadChart();
  </script>
</body>
</html>
